# (2024-06-28 04:55:50.392)

slit_combine.extract_spectra(**{'target': '4233_44597', 'root': 'rubies-egs61', 'path_to_files': './', 'files': None, 'do_gratings': ['PRISM', 'G395H', 'G395M', 'G235M', 'G140M'], 'join': [0, 3, 5], 'split_uncover': True, 'stuck_threshold': 0.3, 'pad_border': 2, 'sort_by_sn': False, 'position_key': 'y_index', 'mask_cross_dispersion': None, 'cross_dispersion_mask_type': 'trace', 'trace_from_yoffset': True, 'reference_exposure': 'auto', 'trace_niter': 4, 'offset_degree': 0, 'degree_kwargs': {}, 'recenter_all': False, 'nod_offset': None, 'initial_sigma': 7, 'fit_type': 1, 'initial_theta': None, 'fix_params': False, 'input_fix_sigma': None, 'fit_params_kwargs': None, 'diffs': True, 'undo_pathloss': True, 'undo_barshadow': 2, 'use_first_sky': False, 'drizzle_kws': {'step': 1, 'with_pathloss': True, 'wave_sample': 1.05, 'ny': 13, 'dkws': {'oversample': 16, 'pixfrac': 0.8}}, 'get_xobj': False, 'trace_with_xpos': False, 'trace_with_ypos': True, 'get_background': False, 'make_2d_plots': True, 'include_full_pixtab': ['PRISM'], 'plot_kws': {}, 'kwargs': {'min_bar': 0.35, 'flag_profile_kwargs': {'require_multiple': True, 'make_plot': True, 'grow': 2, 'nfilt': -32}}})

rubies-egs61   target: 4233_44597   Files: 3

* Group jw04233006001_nrs1_186-prism   N=3
==================================
get_jwst_dq_bits: DO_NOT_USE+MSA_FAILED_OPEN+HOT+DEAD+OPEN+ADJ_OPEN+SATURATED = 738200579
get_jwst_dq_bits: DO_NOT_USE+MSA_FAILED_OPEN+HOT+DEAD+OPEN+ADJ_OPEN+SATURATED = 738200579
flag_nircam_hot_pixels : hot=1 plus=0
get_jwst_dq_bits: DO_NOT_USE+MSA_FAILED_OPEN+HOT+DEAD+OPEN+ADJ_OPEN+SATURATED = 738200579
get_jwst_dq_bits: DO_NOT_USE+MSA_FAILED_OPEN+HOT+DEAD+OPEN+ADJ_OPEN+SATURATED = 738200579
flag_nircam_hot_pixels : hot=1 plus=0
get_jwst_dq_bits: DO_NOT_USE+MSA_FAILED_OPEN+HOT+DEAD+OPEN+ADJ_OPEN+SATURATED = 738200579
get_jwst_dq_bits: DO_NOT_USE+MSA_FAILED_OPEN+HOT+DEAD+OPEN+ADJ_OPEN+SATURATED = 738200579
flag_nircam_hot_pixels : hot=1 plus=0
 0 jw04233006001_03101_00002_nrs1_phot.186.4233_44597.fits (24, 431)  1 flagged hot pixels
 1 jw04233006001_03101_00003_nrs1_phot.186.4233_44597.fits (24, 431)  1 flagged hot pixels
 2 jw04233006001_03101_00004_nrs1_phot.186.4233_44597.fits (24, 431)  1 flagged hot pixels
 extra_slit_dq_flags: (msaexp_badpix_nrs1.yaml)  N=0
 extra_slit_dq_flags: (msaexp_badpix_nrs1.yaml)  N=0
 extra_slit_dq_flags: (msaexp_badpix_nrs1.yaml)  N=0
   ./jw04233006001_03101_00002_nrs1_phot.186.4233_44597.fits source_type=None  undo PATHLOSS_UN
   ./jw04233006001_03101_00003_nrs1_phot.186.4233_44597.fits source_type=None  undo PATHLOSS_UN
   ./jw04233006001_03101_00004_nrs1_phot.186.4233_44597.fits source_type=None  undo PATHLOSS_UN
 Recomputed offsets slit     : force [ 0.00,  5.07, -5.07] pix offsets
 apply_spline_bar_correction :  (mode='wave')
 get_global_sky              : jw04233006001_sky.csv to sky_arrays
 get_normalization_correction: prism_slit_renormalize.yaml quadrant=4 xcen=291 ycen=50
 flag_trace_outliers         : 3 pixels  / yslit = [-2, 2]
 flag_percentile_outliers    : 0 pixels  / plevels [0.95, -4, -0.1] threshold=3.023 (dilate=True)
 flag_percentile_outliers    : calculated 0.950000 0.997281 0.999932
 flag_from_profile           : 6 ( 0.0%) pixels
 multiple mask               : 0 pixels in >= 2 exposures

keys: ['jw04233006001_nrs1_186-prism']

##### Group #1 / 1: jw04233006001_nrs1_186-prism ####

   fit_all_traces, iter 0
     115  sigma=7.00  [ 0.000]  4231.8
     116  sigma=6.01  [ 0.040]  4118.9
     Exposure group 2   dchi2 =    -112.9

     117  sigma=6.01  [ 0.040]  4607.6
     118  sigma=6.01  [ 0.040]  4607.6
     Exposure group 1   dchi2 =       0.0

     119  sigma=6.01  [ 0.040]  4989.4
     120  sigma=6.01  [ 0.040]  4989.4
     Exposure group 3   dchi2 =       0.0

   fit_all_traces, iter 1
     142  sigma=6.01  [ 0.040]  4110.2
     143  sigma=5.87  [ 0.045]  4108.2
     Exposure group 2   dchi2 =      -2.0*

     144  sigma=5.87  [ 0.045]  4561.6
     145  sigma=5.87  [ 0.045]  4561.6
     Exposure group 1   dchi2 =       0.0

     146  sigma=5.87  [ 0.045]  4987.2
     147  sigma=5.87  [ 0.045]  4987.2
     Exposure group 3   dchi2 =       0.0

   fit_all_traces, iter 2
      93  sigma=5.87  [ 0.045]  4108.4
      94  sigma=5.86  [ 0.045]  4108.3
     Exposure group 2   dchi2 =      -0.0*

      95  sigma=5.86  [ 0.045]  4557.4
      96  sigma=5.86  [ 0.045]  4557.4
     Exposure group 1   dchi2 =       0.0

      97  sigma=5.86  [ 0.045]  4988.6
      98  sigma=5.86  [ 0.045]  4988.6
     Exposure group 3   dchi2 =       0.0

   fit_all_traces, iter 3
     116  sigma=5.86  [ 0.045]  4108.4
     117  sigma=5.85  [ 0.046]  4108.4
     Exposure group 2   dchi2 =      -0.0*

     118  sigma=5.85  [ 0.046]  4556.9
     119  sigma=5.85  [ 0.046]  4556.9
     Exposure group 1   dchi2 =       0.0

     120  sigma=5.85  [ 0.046]  4988.8
     121  sigma=5.85  [ 0.046]  4988.8
     Exposure group 3   dchi2 =       0.0


gratings: {'prism': ['jw04233006001_nrs1_186-prism']}
slit_prf_fraction: mu = -0.10, sigma = 0.6 pix
slit_prf_fraction: mu = 0.00, sigma = 0.0 pix
slit_prf_fraction: mu = -0.12, sigma = 0.6 pix
slit_prf_fraction: mu = 0.00, sigma = 0.0 pix
slit_prf_fraction: mu = -0.14, sigma = 0.6 pix
slit_prf_fraction: mu = 0.00, sigma = 0.0 pix
msaexp.drizzle.extract_from_hdul: Initial center =    0.00, sigma =   0.59
msaexp.drizzle.extract_from_hdul: dchi2/dcenter = 26114.8
msaexp.drizzle.extract_from_hdul: aperture extraction = (13, 1)
msaexp.drizzle.extract_from_hdul:  Output center =   -0.00, sigma =   0.59
rubies-egs61_prism-clear_4233_44597.spec.fits
rubies-egs61_prism-clear_4233_44597.pixtab.fits
# (2024-06-28 04:56:00.806)

slit_combine.extract_spectra(**{'target': '4233_44597', 'root': 'rubies-egs61', 'path_to_files': './', 'files': None, 'do_gratings': ['PRISM', 'G395H', 'G395M', 'G235M', 'G140M'], 'join': [0, 3, 5], 'split_uncover': True, 'stuck_threshold': 0.3, 'pad_border': 2, 'sort_by_sn': False, 'position_key': 'y_index', 'mask_cross_dispersion': None, 'cross_dispersion_mask_type': 'trace', 'trace_from_yoffset': True, 'reference_exposure': 'auto', 'trace_niter': 4, 'offset_degree': 0, 'degree_kwargs': {}, 'recenter_all': False, 'nod_offset': None, 'initial_sigma': 7, 'fit_type': 1, 'initial_theta': None, 'fix_params': False, 'input_fix_sigma': None, 'fit_params_kwargs': None, 'diffs': False, 'undo_pathloss': True, 'undo_barshadow': 2, 'use_first_sky': False, 'drizzle_kws': {'step': 1, 'with_pathloss': True, 'wave_sample': 1.05, 'ny': 13, 'dkws': {'oversample': 16, 'pixfrac': 0.8}}, 'get_xobj': False, 'trace_with_xpos': False, 'trace_with_ypos': True, 'get_background': False, 'make_2d_plots': True, 'include_full_pixtab': ['PRISM'], 'plot_kws': {}, 'kwargs': {'estimate_sky_kwargs': {'mask_yslit': [[-4.5, 4.5]], 'min_bar': 0.95, 'df': 81, 'high_clip': 1.0, 'make_plot': True}, 'min_bar': 0.35, 'flag_profile_kwargs': {'require_multiple': True, 'make_plot': True, 'grow': 2, 'nfilt': -32}}})

rubies-egs61   target: 4233_44597   Files: 3

* Group jw04233006001_nrs1_186-prism   N=3
==================================
get_jwst_dq_bits: DO_NOT_USE+MSA_FAILED_OPEN+HOT+DEAD+OPEN+ADJ_OPEN+SATURATED = 738200579
get_jwst_dq_bits: DO_NOT_USE+MSA_FAILED_OPEN+HOT+DEAD+OPEN+ADJ_OPEN+SATURATED = 738200579
flag_nircam_hot_pixels : hot=1 plus=0
get_jwst_dq_bits: DO_NOT_USE+MSA_FAILED_OPEN+HOT+DEAD+OPEN+ADJ_OPEN+SATURATED = 738200579
get_jwst_dq_bits: DO_NOT_USE+MSA_FAILED_OPEN+HOT+DEAD+OPEN+ADJ_OPEN+SATURATED = 738200579
flag_nircam_hot_pixels : hot=1 plus=0
get_jwst_dq_bits: DO_NOT_USE+MSA_FAILED_OPEN+HOT+DEAD+OPEN+ADJ_OPEN+SATURATED = 738200579
get_jwst_dq_bits: DO_NOT_USE+MSA_FAILED_OPEN+HOT+DEAD+OPEN+ADJ_OPEN+SATURATED = 738200579
flag_nircam_hot_pixels : hot=1 plus=0
 0 jw04233006001_03101_00002_nrs1_phot.186.4233_44597.fits (24, 431)  1 flagged hot pixels
 1 jw04233006001_03101_00003_nrs1_phot.186.4233_44597.fits (24, 431)  1 flagged hot pixels
 2 jw04233006001_03101_00004_nrs1_phot.186.4233_44597.fits (24, 431)  1 flagged hot pixels
 extra_slit_dq_flags: (msaexp_badpix_nrs1.yaml)  N=0
 extra_slit_dq_flags: (msaexp_badpix_nrs1.yaml)  N=0
 extra_slit_dq_flags: (msaexp_badpix_nrs1.yaml)  N=0
   ./jw04233006001_03101_00002_nrs1_phot.186.4233_44597.fits source_type=None  undo PATHLOSS_UN
   ./jw04233006001_03101_00003_nrs1_phot.186.4233_44597.fits source_type=None  undo PATHLOSS_UN
   ./jw04233006001_03101_00004_nrs1_phot.186.4233_44597.fits source_type=None  undo PATHLOSS_UN
 Recomputed offsets slit     : force [ 0.00,  5.07, -5.07] pix offsets
 apply_spline_bar_correction :  (mode='wave')
 get_global_sky              : jw04233006001_sky.csv to sky_arrays
 get_normalization_correction: prism_slit_renormalize.yaml quadrant=4 xcen=291 ycen=50
 flag_trace_outliers         : 3 pixels  / yslit = [-2, 2]
 flag_percentile_outliers    : 0 pixels  / plevels [0.95, -4, -0.1] threshold=3.023 (dilate=True)
 flag_percentile_outliers    : calculated 0.950000 0.997281 0.999932
 estimate_sky                : 13 outliers > 7  / N=3597 sky pixels 
 flag_trace_outliers         : 0 pixels  / yslit = [-2, 2]
 flag_percentile_outliers    : 0 pixels  / plevels [0.95, -4, -0.1] threshold=3.027 (dilate=True)
 flag_percentile_outliers    : calculated 0.950000 0.997281 0.999932
 flag_from_profile           : 6 ( 0.0%) pixels
 multiple mask               : 2 pixels in >= 2 exposures

keys: ['jw04233006001_nrs1_186-prism']

##### Group #1 / 1: jw04233006001_nrs1_186-prism ####

   fit_all_traces, iter 0
     165  sigma=7.00  [ 0.000]  3326.4
     166  sigma=6.37  [ 0.035]  3284.8
     Exposure group 2   dchi2 =     -41.6

     167  sigma=6.37  [ 0.035]  3301.6
     168  sigma=6.37  [ 0.035]  3301.6
     Exposure group 1   dchi2 =       0.0

     169  sigma=6.37  [ 0.035]  3944.6
     170  sigma=6.37  [ 0.035]  3944.6
     Exposure group 3   dchi2 =       0.0

   fit_all_traces, iter 1
      45  sigma=6.37  [ 0.035]  3284.8
      46  sigma=6.37  [ 0.035]  3284.8
     Exposure group 2   dchi2 =      -0.0*

      47  sigma=6.37  [ 0.035]  3301.6
      48  sigma=6.37  [ 0.035]  3301.6
     Exposure group 1   dchi2 =       0.0

      49  sigma=6.37  [ 0.035]  3944.6
      50  sigma=6.37  [ 0.035]  3944.6
     Exposure group 3   dchi2 =       0.0

   fit_all_traces, iter 2
      45  sigma=6.37  [ 0.035]  3284.8
      46  sigma=6.37  [ 0.035]  3284.8
     Exposure group 2   dchi2 =       0.0*

      47  sigma=6.37  [ 0.035]  3301.6
      48  sigma=6.37  [ 0.035]  3301.6
     Exposure group 1   dchi2 =       0.0

      49  sigma=6.37  [ 0.035]  3944.6
      50  sigma=6.37  [ 0.035]  3944.6
     Exposure group 3   dchi2 =       0.0

   fit_all_traces, iter 3
      45  sigma=6.37  [ 0.035]  3284.8
      46  sigma=6.37  [ 0.035]  3284.8
     Exposure group 2   dchi2 =       0.0*

      47  sigma=6.37  [ 0.035]  3301.6
      48  sigma=6.37  [ 0.035]  3301.6
     Exposure group 1   dchi2 =       0.0

      49  sigma=6.37  [ 0.035]  3944.6
      50  sigma=6.37  [ 0.035]  3944.6
     Exposure group 3   dchi2 =       0.0


gratings: {'prism': ['jw04233006001_nrs1_186-prism']}
slit_prf_fraction: mu = -0.10, sigma = 0.6 pix
slit_prf_fraction: mu = 0.00, sigma = 0.0 pix
slit_prf_fraction: mu = -0.12, sigma = 0.6 pix
slit_prf_fraction: mu = 0.00, sigma = 0.0 pix
slit_prf_fraction: mu = -0.14, sigma = 0.6 pix
slit_prf_fraction: mu = 0.00, sigma = 0.0 pix
msaexp.drizzle.extract_from_hdul: Initial center =    0.00, sigma =   0.64
msaexp.drizzle.extract_from_hdul: dchi2/dcenter = 34336.2
msaexp.drizzle.extract_from_hdul: aperture extraction = (13, 1)
msaexp.drizzle.extract_from_hdul:  Output center =   -0.00, sigma =   0.64
rubies-egs61_prism-clear_4233_44597.spec.fits
rubies-egs61_prism-clear_4233_44597.pixtab.fits
